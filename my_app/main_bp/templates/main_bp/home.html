{% extends 'base.html' %}

{% from '_formhelpers.html' import render_field %}

{% block content %}
<div style="display: flex; justify-content: space-between; align-items: center; margin: 25px;">
    <div style="display: flex; flex-direction: column; align-items: start;">
        <h2>–í—Å–µ —Å—Ç–∞—Ç—å–∏ –∑–¥–µ—Å—å:</h2>

        {% for post in posts %}
            <article style="border: 1px solid #ccc; padding: 10px; margin-bottom: 10px;">
                <h3>{{ post.title }}</h3>
                <p>{{ post.content }}</p>
                <p>{{ post.date_posted.strftime('%Y-%m-%d %H:%M') }}</p>
                <p>–ê–≤—Ç–æ—Ä: {{ post.author.username }}</p>
                <div class="likes-section">
                    <button class="like-button" data-post-id="{{ post.id }}">
                        <span class="like-icon">
                            {% if current_user.is_authenticated and current_user in post.liked_by_users %}
                            ‚ù§Ô∏è
                            {% else %}
                            ü§ç
                            {% endif %}
                        </span>
                        <span class="like-count">{{ post.likes_count }}</span> –ª–∞–π–∫–æ–≤
                    </button>
                </div>
                <hr>
                <h4>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ (<span id="comment-count">{{ post.comments.count() }}</span>)</h4>
                <div id="comments-container">
                    –ó–¥–µ—Å—å –ø–æ–∫–∞ –Ω–∏—á–µ–≥–æ –Ω–µ—Ç, –±—É–¥—å—Ç–µ –ø–µ—Ä–≤—ã–º, –∫—Ç–æ –æ—Å—Ç–∞–≤–∏—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π!
                </div>

                {% if current_user.is_authenticated %}
                    <form id="comment-form" data-post-id="{{ post.id }}" method="post" novalidate>
                        {{ form.hidden_tag() }}

                        <h5>–û—Å—Ç–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</h5>
                        <div id="comment-error" style="color: red; display: none;"></div>

                        <div>
                            {{ render_field(form.text) }}
                            {{ render_field(form.submit, class_='btn btn-primary') }}
                        </div>
                    </form>
                {% else %}
                    <p>–ß—Ç–æ–±—ã –æ—Å—Ç–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞ <a href="{{ url_for(auth_bp.auth) }}">–í–æ–π–¥–∏—Ç–µ</a> –≤ –∞–∫–∫–∞—É–Ω—Ç</p>
                {% endif %}
            </article>
        {% endfor %}
    </div>

    <div style="display: flex; flex-direction: column; align-items: end;">
        <h2>–í–∞—à–∏ —Å—Ç–∞—Ç—å–∏ –∑–¥–µ—Å—å:</h2>

        {% for user_post in user_posts %}
            <article style="border: 1px solid #ccc; padding: 10px; margin-bottom: 10px;">
                <h3>{{ user_post.title }}</h3>
                <p>{{ user_post.content }}</p>
                <p>{{ user_post.date_posted.strftime('%Y-%m-%d %H:%M') }}</p>
            </article>
        {% endfor %}
    </div>
</div>
{% endblock %}